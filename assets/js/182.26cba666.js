(window.webpackJsonp=window.webpackJsonp||[]).push([[182],{547:function(t,e,n){"use strict";n.r(e);var a=n(49),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"segmentation-mixins-segmentation-mixins"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#segmentation-mixins-segmentation-mixins"}},[t._v("#")]),t._v(" Segmentation Mixins {#segmentation-mixins}")]),t._v(" "),n("p",[n("RouterLink",{attrs:{to:"/zh/cornerstone-tools/latest/tool-types/#segmentation-tool"}},[t._v('"Segmentation Tools"')]),t._v(" are "),n("code",[t._v("BaseTool")]),t._v("s that implement a segmentation mixin.")],1),t._v(" "),n("p",[t._v("The role of a segmentation mixin is to provide a delineation mechanism, which generates an "),n("code",[t._v("operationData")]),t._v(" object which is passed to the active strategy alongside the cornerstone event.")]),t._v(" "),n("p",[t._v("Examples of segmentation mixins could be:")]),t._v(" "),n("ul",[n("li",[t._v("User draws a shape as input.")]),t._v(" "),n("li",[t._v("User clicks one or more seed points as input on one frame.")]),t._v(" "),n("li",[t._v("User clicks at the top and bottom of a region of interest (on different frames) in an axial series.")])]),t._v(" "),n("p",[t._v("Although segmentation tools may have very specific uses (e.g. the last example above could be used as seeds for an AI-powered spine segmentation, by providing the spine's extent), segmentation mixins themselves are intended to be reusable in many contexts. Other than their intended use case, segmentation mixins are functionally just mixins in the context of "),n("code",[t._v("cornerstoneTools")]),t._v(", so can be "),n("RouterLink",{attrs:{to:"/zh/cornerstone-tools/latest/third-party-functionality/"}},[t._v("injected by plugins like any other mixin")]),t._v(".")],1),t._v(" "),n("p",[t._v("As the delineation mechanisms can vary from simple to complex, the only requirement of a segmentation mixin is that it must call "),n("code",[t._v("BaseTool")]),t._v("'s "),n("code",[t._v("this.applyActiveStrategy(evt, operationData)")]),t._v(" with the "),n("code",[t._v("operationData")]),t._v(" it produces at the end of the delination cycle.")]),t._v(" "),n("p",[t._v("Taking the "),n("code",[t._v("circleSegmentationMixin")]),t._v(" as an example:")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @mixin circleSegmentationMixin - Segmentation operations for circles.\n * @memberof Mixins\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  postTouchStartCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _startOutliningRegion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  postMouseDownCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _startOutliningRegion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  mouseClickCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _startOutliningRegion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  touchDragCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _setHandlesAndUpdate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  mouseDragCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _setHandlesAndUpdate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  mouseMoveCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _setHandlesAndUpdate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  touchEndCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _applyStrategy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  mouseUpCallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _applyStrategy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  initializeMixin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _resetHandles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  renderToolData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v('This mixin implements a "drag-to-define-a-circle" delineation mechanism, and as such plugs its methods into '),n("code",[t._v("BaseTool")]),t._v(" API for dealing with appropriate user input such as down/touch, drag and release for both mouse and touch interactions.")]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("renderToolData")]),t._v(" function renders the circle to the canvas whilst dilineation is in process.")]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("_applyStrategy")]),t._v(" function here calls "),n("code",[t._v("BaseTool")]),t._v("'s "),n("code",[t._v("applyActiveStrategy")]),t._v(" method:")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//src/mixins/segmentation/circleSegmentationMixin.js")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" operationData "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pixelData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentIndex"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" labelmap3D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("activeSegmentIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentationMixinType"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("circleSegmentationMixin")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("applyActiveStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("evt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" operationData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),n("p",[t._v("Here the "),n("code",[t._v("operationData")]),t._v(" contains information about the delineation. The "),n("code",[t._v("segmentationMixinType")]),t._v(" property just defines a key that tells the strategy what sort of "),n("code",[t._v("operationData")]),t._v(" it is recieving, so that it knows what to process, or can throw if it can't process operations from that mixin. E.g.:")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//src/util/segmentation/operations/fillInsideCircle.js")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("operationData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("segmentationMixinType "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("circleSegmentationMixin")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  logger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("fillInsideCircle operation requires circleSegmentationMixin operationData, recieved ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("\n      operationData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("segmentationMixinType\n    "),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),n("h3",{attrs:{id:"core-segmentation-mixins"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#core-segmentation-mixins"}},[t._v("#")]),t._v(" Core Segmentation Mixins")]),t._v(" "),n("p",[t._v("Here are the segmentation mixins present in the core "),n("code",[t._v("cornerstoneTools")]),t._v(" library. They power the various scissor and correction tools.")]),t._v(" "),n("h4",{attrs:{id:"circlesegmentationmixin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#circlesegmentationmixin"}},[t._v("#")]),t._v(" circleSegmentationMixin")]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("circleSegmentationMixin")]),t._v(" allows the user to draw a circle on a single frame of a series via a touch/mouse drag. On mouse up/touch end, the mixin calls the Tool's "),n("code",[t._v("activeStrategy")]),t._v(" with the following "),n("code",[t._v("operationData")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" operationData "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pixelData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentIndex"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" labelmap3D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("activeSegmentIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentationMixinType"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("circleSegmentationMixin")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("Where:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("points")]),t._v(" - An object with two points "),n("code",[t._v("start")]),t._v(" and "),n("code",[t._v("end")]),t._v(" containing the ("),n("code",[t._v("x")]),t._v(","),n("code",[t._v("y")]),t._v(") coordinates of the centre of the circle and a point on its edge.")]),t._v(" "),n("li",[n("code",[t._v("pixelData")]),t._v(" - The "),n("code",[t._v("pixelData")]),t._v(" of the "),n("code",[t._v("Labelmap2D")]),t._v(" that corresponds with the image.")]),t._v(" "),n("li",[t._v("The "),n("code",[t._v("segmentIndex")]),t._v(" to apply the operation to.")]),t._v(" "),n("li",[n("code",[t._v("segmentationMixinType")]),t._v(" - The mixin identifier.")])]),t._v(" "),n("h4",{attrs:{id:"freehandsegmentationmixin-polylinesegmentationmixin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#freehandsegmentationmixin-polylinesegmentationmixin"}},[t._v("#")]),t._v(" freehandSegmentationMixin / polylineSegmentationMixin")]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("freehandSegmentationMixin")]),t._v(" allows the user to draw a freehand polygon on a single frame of a series via a touch/mouse drag. On mouse up/touch end, the mixin calls the Tool's "),n("code",[t._v("activeStrategy")]),t._v(" with the following "),n("code",[t._v("operationData")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" operationData "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pixelData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentIndex"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" labelmap3D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("activeSegmentIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentationMixinType"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("circleSegmentationMixin")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("Where:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("points")]),t._v(" - An array of points containing the ("),n("code",[t._v("x")]),t._v(","),n("code",[t._v("y")]),t._v(") coordinates of the nodes along its points.")]),t._v(" "),n("li",[n("code",[t._v("pixelData")]),t._v(" - The "),n("code",[t._v("pixelData")]),t._v(" of the "),n("code",[t._v("Labelmap2D")]),t._v(" that corresponds with the image.")]),t._v(" "),n("li",[t._v("The "),n("code",[t._v("segmentIndex")]),t._v(" to apply the operation to.")]),t._v(" "),n("li",[n("code",[t._v("segmentationMixinType")]),t._v(" - The mixin identifier.")])]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("freehandSegmentationMixin")]),t._v("'s "),n("code",[t._v("renderTooldata")]),t._v(" method connects the first and last point whilst drawing, signifying a closed polygon to the user. If you wish to display just the open polyline for a Tool whilst deliniating, use the "),n("code",[t._v("polylineSegmentationMixin")]),t._v(" instead, which implements the "),n("code",[t._v("freehandSegmentationMixin")]),t._v(" but overrides its "),n("code",[t._v("renderToolData")]),t._v(" method to display just the line.")]),t._v(" "),n("h4",{attrs:{id:"rectanglesegmentationmixin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rectanglesegmentationmixin"}},[t._v("#")]),t._v(" rectangleSegmentationMixin")]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("rectangleSegmentationMixin")]),t._v(" allows the user to draw a rectangle on a single frame of a series via a touch/mouse drag. On mouse up/touch end, the mixin calls the Tool's "),n("code",[t._v("activeStrategy")]),t._v(" with the following "),n("code",[t._v("operationData")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" operationData "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pixelData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentIndex"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" labelmap3D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("activeSegmentIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  segmentationMixinType"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("circleSegmentationMixin")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("Where:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("points")]),t._v(" - An array with two points containing the ("),n("code",[t._v("x")]),t._v(","),n("code",[t._v("y")]),t._v(") coordinates of the top left and the bottom right of the rectangle.")]),t._v(" "),n("li",[n("code",[t._v("pixelData")]),t._v(" - The "),n("code",[t._v("pixelData")]),t._v(" of the "),n("code",[t._v("Labelmap2D")]),t._v(" that corresponds with the image.")]),t._v(" "),n("li",[t._v("The "),n("code",[t._v("segmentIndex")]),t._v(" to apply the operation to.")]),t._v(" "),n("li",[n("code",[t._v("segmentationMixinType")]),t._v(" - The mixin identifier.")])])])}),[],!1,null,null,null);e.default=s.exports}}]);