(window.webpackJsonp=window.webpackJsonp||[]).push([[235],{601:function(t,e,a){"use strict";a.r(e);var s=a(49),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"开发者指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发者指南"}},[t._v("#")]),t._v(" 开发者指南")]),t._v(" "),a("p",[t._v("要想编辑或改造 Cornerstone，您将需要安装 "),a("a",{attrs:{href:"http://nodejs.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node.js"),a("OutboundLink")],1),t._v("。npm 包管理器随着 Node.js 附带一起安装，你可以使用它们来安装项目依赖，并且运行常用的开发任务。")]),t._v(" "),a("h2",{attrs:{id:"常用任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用任务"}},[t._v("#")]),t._v(" 常用任务")]),t._v(" "),a("h4",{attrs:{id:"安装依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[t._v("#")]),t._v(" 安装依赖")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("安装/更新依赖项应该在git存储库的每次更新之后执行。如果不执行此操作，您可能会在开发过程中遇到问题。")])]),t._v(" "),a("h4",{attrs:{id:"运行生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行生成"}},[t._v("#")]),t._v(" 运行生成")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" start\n")])])]),a("p",[t._v("运行生成将同时创建这个库的压缩和未压缩的版本，以及它们各自的 source map 文件。")]),t._v(" "),a("h4",{attrs:{id:"在每次变更后自动运行生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在每次变更后自动运行生成"}},[t._v("#")]),t._v(" 在每次变更后自动运行生成")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),t._v("\n")])])]),a("p",[t._v("如果要调试问题或向源代码添加新功能，可以使用此命令。")]),t._v(" "),a("h4",{attrs:{id:"发布开发使用的文件服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布开发使用的文件服务"}},[t._v("#")]),t._v(" 发布开发使用的文件服务")]),t._v(" "),a("p",[t._v("有很多方法运行一个简单的 HTTP 服务器。下面只举一个例，您也可以使用其它，如 "),a("code",[t._v("python -m simplehttpserver 8080")])]),t._v(" "),a("ol",[a("li",[t._v("安装 "),a("code",[t._v("http-server")]),t._v(" 包:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" http-server -g\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("有时候您可能需要使用 sudo 去执行全局安装。")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("运行服务器")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("http-server\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("访问 "),a("a",{attrs:{href:"http://127.0.0.1:8080/example/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://127.0.0.1:8080/example/index.html"),a("OutboundLink")],1),t._v(" 在浏览器加载示例。")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("要想在移动设备上访问这些，您需要运行 HTTP 服务器，然后通过电脑 IP 地址进行访问（比如："),a("a",{attrs:{href:"http://192.168.1.11:8080/example/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://192.168.1.11:8080/example/index.html"),a("OutboundLink")],1),t._v("）")])]),t._v(" "),a("h4",{attrs:{id:"运行和调试测试用例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行和调试测试用例"}},[t._v("#")]),t._v(" 运行和调试测试用例")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n")])])]),a("p",[t._v("运行测试时，将创建一个“coverage”目录。请注意，因为它只是一个构建生成文件，所以在主代码库中不存在这个目录。通过浏览器打开“coverage/html/index.html”这个 HTML 文件（不必启用一个 HTTP 服务器），您能够查看和检查测试覆盖报告。")]),t._v(" "),a("p",[a("img",{attrs:{src:"$withBase/assets/img/istanbul-code-coverage.png",alt:"Istanbul Code Coverage Report"}})]),t._v(" "),a("p",[t._v("当启动了测试之后，您还可以用浏览器访问 http://0.0.0.0:9876/debug ，通过 Karma 测试程序去进行测试的调试。请注意，这个 URL 不会立即生效，因为 "),a("code",[t._v("npm test")]),t._v(" 命令的第一步是重新构建整个库。")]),t._v(" "),a("h4",{attrs:{id:"运行代码风格检测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行代码风格检测"}},[t._v("#")]),t._v(" 运行代码风格检测")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run eslint\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Or include automatic fixing with:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run eslint-fix\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Or automatically fix 'test' directory with:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run eslint-fix-test\n")])])]),a("p",[t._v("Running the commands above will check the source code for linting issues.")]),t._v(" "),a("h4",{attrs:{id:"submitting-changes-through-pull-requests"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#submitting-changes-through-pull-requests"}},[t._v("#")]),t._v(" Submitting changes through Pull Requests")]),t._v(" "),a("p",[t._v("If you have made a source code change that you think should be included in the main repository, you can contribute it back to the community by creating a "),a("a",{attrs:{href:"https://github.com/cornerstonejs/cornerstone/pulls",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pull Request"),a("OutboundLink")],1),t._v(". Please create an associated "),a("a",{attrs:{href:"https://github.com/cornerstonejs/cornerstone/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("Issue"),a("OutboundLink")],1),t._v(" to describe the problem you are solving / feature you are adding so the library maintainers can give you feedback on whether or not these changes are appropriate for the repository. It's possible that your bug fix / new feature would be better implemented in another library (e.g. "),a("a",{attrs:{href:"https://github.com/chafey/cornerstoneTools/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cornerstone Tools"),a("OutboundLink")],1),t._v("). Please ensure that all tests pass and you have run ESLint and fixed any issues before submitting a pull request.")]),t._v(" "),a("h2",{attrs:{id:"development-toolchain-and-specifications"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#development-toolchain-and-specifications"}},[t._v("#")]),t._v(" Development Toolchain and Specifications")]),t._v(" "),a("p",[t._v("Cornerstone relies on a number of open source tools, components, and free services to ensure quality and stability. We want to ensure developers can work in modern JavaScript and that end users can use the tools in both current and legacy environments.")]),t._v(" "),a("h4",{attrs:{id:"general"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#general"}},[t._v("#")]),t._v(" General")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://babeljs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Babel"),a("OutboundLink")],1),t._v(" for transpilation from next generation JavaScript to more widely supported previous JavaScript versions.")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://webpack.js.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebPack"),a("OutboundLink")],1),t._v(" to bundle the project")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://eslint.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ESLint"),a("OutboundLink")],1),t._v(" is used to enforce code styling and maintain quality")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("NPM"),a("OutboundLink")],1),t._v(" is used to host the installable package. See "),a("a",{attrs:{href:"https://www.npmjs.com/package/cornerstone-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cornerstone Core on NPM"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://semver.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Semantic Versioning"),a("OutboundLink")],1),t._v(" is used for versioning of the library.")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://keepachangelog.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("keep a changelog"),a("OutboundLink")],1),t._v(" is used for the formatting of the changelog.")])]),t._v(" "),a("h4",{attrs:{id:"testing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#testing"}},[t._v("#")]),t._v(" Testing")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://karma-runner.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Karma"),a("OutboundLink")],1),t._v(" is used as a test runner")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://mochajs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mocha"),a("OutboundLink")],1),t._v(" is used as a test framework")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://chaijs.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chai"),a("OutboundLink")],1),t._v(" is used for test assertions")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://istanbul.js.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Istanbul"),a("OutboundLink")],1),t._v(" is used to report code coverage")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://travis-ci.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Travis CI"),a("OutboundLink")],1),t._v(" is used to automatically run tests. See "),a("a",{attrs:{href:"https://travis-ci.org/cornerstonejs/cornerstone",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cornerstone Core on Travis CI"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://coveralls.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Coveralls"),a("OutboundLink")],1),t._v(" is used to display code coverage following automatic tests. See "),a("a",{attrs:{href:"https://coveralls.io/github/cornerstonejs/cornerstone?branch=master",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cornerstone Core Coveralls Test Coverage"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/GoogleChrome/puppeteer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Headless Chrome"),a("OutboundLink")],1),t._v(" is used for running headless tests.")])]),t._v(" "),a("h4",{attrs:{id:"documentation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#documentation"}},[t._v("#")]),t._v(" Documentation")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://usejsdoc.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSDoc"),a("OutboundLink")],1),t._v(" formatting is used for documenting the source code.")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://documentation.js.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("documentation.js"),a("OutboundLink")],1),t._v(" generates API documentation in Markdown from JSDoc annotations")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.gitbook.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitBook"),a("OutboundLink")],1),t._v(" transforms the Markdown documentation into HTML")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://pages.github.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Github Pages"),a("OutboundLink")],1),t._v(" hosts the documentation")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.cloudflare.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cloudflare"),a("OutboundLink")],1),t._v(" is placed in front of Github Pages to serve the documentation over HTTPS.")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://rawgit.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rawgit"),a("OutboundLink")],1),t._v(" is used to serve "),a("RouterLink",{attrs:{to:"/example/index.html"}},[t._v("Live Examples")]),t._v(" from the repository. We should transition this to be hosted with Github Pages as well.")],1)]),t._v(" "),a("h2",{attrs:{id:"writing-tests"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#writing-tests"}},[t._v("#")]),t._v(" Writing tests")]),t._v(" "),a("p",[t._v("Here are some general notes on writing tests which may be useful:")]),t._v(" "),a("ul",[a("li",[t._v("Tests must be in the 'test' directory. Please try to ensure they follow the 'src' directory layout for simplicity.")]),t._v(" "),a("li",[t._v('Test file names must end in "_test.js"')]),t._v(" "),a("li",[t._v("The 'coverage_test.js' file ensures that all files are considered by Istanbul, so that code coverage reports can be used to explore the whole repository.")]),t._v(" "),a("li",[t._v("Do not convert 'function ()' to arrow functions (i.e. '=> {}') within the 'it', 'should', or 'describe' blocks or Mocha will fail to run the tests properly.")])]),t._v(" "),a("h2",{attrs:{id:"releasing-a-new-version"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#releasing-a-new-version"}},[t._v("#")]),t._v(" Releasing a new version")]),t._v(" "),a("ol",[a("li",[t._v("Make sure you have the latest commits from master")]),t._v(" "),a("li",[t._v("Determine the version change you need to make based on the scope of the changes since the last release.")]),t._v(" "),a("li",[t._v("Update the "),a("a",{attrs:{href:"https://github.com/cornerstonejs/cornerstone/blob/master/changelog.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("changelog"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[t._v("Make sure to thank any code contributors!")])]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v('Update the package and dependency versions in "package.json"')]),t._v(" "),a("li",[t._v("Update the build version:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run version\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[t._v("Run the build:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])])]),a("ol",{attrs:{start:"7"}},[a("li",[t._v("Commit the changes")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -am "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bump version <version>"')]),t._v("\n")])])]),a("ol",{attrs:{start:"8"}},[a("li",[t._v("Tag the commits with the version number and title")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" tag -a "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<version>"')]),t._v(" -m "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Version <version>"')]),t._v("\n")])])]),a("ol",{attrs:{start:"9"}},[a("li",[t._v("Push the commit with the version number to master")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push origin master --tags\n")])])]),a("ol",{attrs:{start:"10"}},[a("li",[t._v("Publish the release to NPM:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" publish\n")])])]),a("h2",{attrs:{id:"updating-docs-with-gitbook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#updating-docs-with-gitbook"}},[t._v("#")]),t._v(" Updating Docs with gitbook")]),t._v(" "),a("h3",{attrs:{id:"if-its-your-first-time"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#if-its-your-first-time"}},[t._v("#")]),t._v(" If its your first time:")]),t._v(" "),a("ol",[a("li",[t._v("Make sure you have gitbook-cli installed globally, if not, run:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g gitbook-cli\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Go inside the /docs folder and do:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("gitbook "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])]),a("h3",{attrs:{id:"updating-files-and-deploying"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#updating-files-and-deploying"}},[t._v("#")]),t._v(" Updating files and deploying")]),t._v(" "),a("ol",[a("li",[t._v("On the root folder run:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run docs\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# It will serve the documentation on http://localhost:4000/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# with livereload ")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Change the docs needed and make sure everything is correct")]),t._v(" "),a("li",[t._v("In order to deploy, run:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run docs:deploy\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);